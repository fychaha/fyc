## redis雪崩

假设在redis中有1000个key，在同一个时间失效的话，会发生什么问题？

这就是雪崩效应，在这种情况下，一旦发生大量访问服务器的情况，会导致数据库访问量过载，服务器就会崩溃。

### 解决方案:

1. 分布式锁（本地锁），不推荐。
2. 使用消息中间件（最靠谱，可以解决高并发，但是成本高）。
3. 一级和二级缓存（redis+ehcache），最简单的，性能不是很好。
4. 均摊分配redis key 的失效时间。

1. #### 使用分布式（本地）锁

   当突然有大量的请求到数据库服务器的时候，进行对数据库服务的请求限制。这个可以使用所得机制，保证只有一个线程（请求）进行数据库的操作访问，否则排队等待。（如果是集群服务器的话，使用分布式锁）。这种方案虽然可以解决雪崩，但是会减少服务器吞吐量。

2. #### 使用消息中间件

   当突然有大量的请求到数据库服务器的时候，如果redis没有值得情况下，会将该消息存放在消息中间件（异步）



