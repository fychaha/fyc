## 存储过程

- 什么是存储过程

  就是一组sql语句集，可以实现复杂逻辑功能，类似于java语言中封装方法。

  ps:存储过程跟触发器类似，都是一组sql集，但是存储过程是主动调用，且功能比触发器更加强大，触发器就是某件事件触发后自动调用。

- 存储过程的特性

  有输入参数，可以声明变量，有if/else,case,while等控制语句，通过编写存储过程，可以实现复杂的逻辑功能；

  函数的普遍特性：模块化，封装，代码复用；

  速度快，只有首次执行需要经过编译和优化步骤，后续被调用可以直接执行，省去以上步骤；

- 创建一个存储程储(无参)

  ```sql
  create procedure user_porced()
  begin
  	select * from users;
  	select * from users;
  	select * from users;
  end;
  ```

  

- 调用存储过程

  ````sql
  call user_porced();
  ````

- 存储过程优缺点

  ###### 优点：

  1. 在生产环境下，可以直接修改存储过程的方式修改业务的逻辑bug，而不用重启服务器。但是风险也大，不要在正式服务器上滥用，后果很严重。
  2. 执行速度快。存储过程编译过后要比单独一条一条执行起来要快。但是效率没多大。如果在做大数据量地导入，同步时就可以使用。
  3. 减少网络传输。存储过程是直接就在数据库服务器上跑的，所有数据访问都在服务器内部执行，不需要传输数据到其他终端。但我们的应付服务器通常与数据库是在同一网络内，大数据的访问瓶颈取决于硬盘速度而不是网速。
  4. 能解决presentation与数据之间的差异，也就是解决00模型与二位数据持久化之间的阻抗
  5. 方便DBA优化。

  ###### 缺点：

  1. 不便调试。基本上没有较好的调试器，
  2. 没办法应用缓存。虽然有全局临时表之类的方法可以作缓存，但是同样加重了数据库的负担。若缓存并发严重，那就要经常加锁，效率堪忧。
  3. 无法适应数据库的切割。数据库切割后，存储过程并不清楚数据存储在哪个数据库中。

- 